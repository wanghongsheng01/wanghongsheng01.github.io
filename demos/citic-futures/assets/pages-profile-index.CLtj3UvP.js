var a=(a,s,e)=>new Promise((t,l)=>{var n=a=>{try{o(e.next(a))}catch(s){l(s)}},u=a=>{try{o(e.throw(a))}catch(s){l(s)}},o=a=>a.done?t(a.value):Promise.resolve(a.value).then(n,u);o((e=e.apply(a,s)).next())});import{d as s,r as e,u as t,o as l,e as n,w as u,s as o,i as r,f as c,g as i,h as d,j as f,k as v,t as _,x as m,F as g,y as p,l as k,G as h,L as y,a as b}from"./index-BWcxsYn8.js";import{C as x}from"./CustomTabBar.CiXty17D.js";import{N as j}from"./NavigationBar.BembfXLU.js";import{m as I}from"./mockApi.Dwynr1J8.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";const w=C(s({__name:"index",setup(s){const C=e(null),w=e(!1);t();const T=()=>a(this,null,function*(){try{w.value=!0;const a=yield I.getUserProfile();200===a.code?C.value=a.data:o({title:a.message,icon:"none"})}catch(a){console.error("获取用户资料失败:",a),o({title:"获取用户资料失败",icon:"none"})}finally{w.value=!1}}),P=()=>{h({title:"安全退出",content:"确定要退出当前账号吗？",confirmText:"确定",cancelText:"取消",confirmColor:"#ef4444",success:s=>a(this,null,function*(){if(s.confirm)try{w.value=!0;200===(yield I.logout("")).code&&(y("token"),y("userInfo"),b({url:"/pages/auth/login"}),o({title:"退出成功",icon:"success"}))}catch(a){console.error("退出登录失败:",a),o({title:"退出失败",icon:"none"})}finally{w.value=!1}})})};return l(()=>{T()}),(a,s)=>{const e=d,t=f,l=r,o=k;return c(),n(l,{class:"profile-page"},{default:u(()=>[i(j,{title:"个人中心"}),i(l,{class:"page-content"},{default:u(()=>[w.value?(c(),n(l,{key:1,class:"user-section skeleton-section"},{default:u(()=>[i(l,{class:"skeleton skeleton-avatar"}),i(l,{class:"user-info"},{default:u(()=>[i(l,{class:"skeleton skeleton-name"}),i(l,{class:"skeleton skeleton-phone"})]),_:1})]),_:1})):(c(),n(l,{key:0,class:"user-section"},{default:u(()=>{var a;return[i(e,{src:(null==(a=C.value)?void 0:a.userInfo.avatar)||"/static/images/default-avatar.svg",class:"user-avatar"},null,8,["src"]),i(l,{class:"user-info"},{default:u(()=>[i(t,{class:"user-name"},{default:u(()=>{var a;return[v(_((null==(a=C.value)?void 0:a.userInfo.nickname)||"用户"),1)]}),_:1}),i(t,{class:"user-phone"},{default:u(()=>{var a,s;return[v(_((s=(null==(a=C.value)?void 0:a.userInfo.phone)||"",s?s.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"):"")),1)]}),_:1})]),_:1})]}),_:1})),w.value?(c(),n(l,{key:3,class:"stats-grid"},{default:u(()=>[(c(),m(g,null,p(4,a=>i(l,{class:"stat-item",key:a},{default:u(()=>[i(t,{class:"stat-label"},{default:u(()=>[v("加载中...")]),_:1}),i(l,{class:"skeleton skeleton-stat"})]),_:2},1024)),64))]),_:1})):(c(),n(l,{key:2,class:"stats-grid"},{default:u(()=>[i(l,{class:"stat-item"},{default:u(()=>[i(t,{class:"stat-label"},{default:u(()=>[v("累计答题")]),_:1}),i(t,{class:"stat-value blue"},{default:u(()=>{var a;return[v(_((null==(a=C.value)?void 0:a.statistics.quiz.totalQuestions)||0),1)]}),_:1})]),_:1}),i(l,{class:"stat-item"},{default:u(()=>[i(t,{class:"stat-label"},{default:u(()=>[v("交易胜率")]),_:1}),i(t,{class:"stat-value green"},{default:u(()=>{var a;return[v(_((null==(a=C.value)?void 0:a.statistics.trading.winRate)||0)+"%",1)]}),_:1})]),_:1}),i(l,{class:"stat-item"},{default:u(()=>[i(t,{class:"stat-label"},{default:u(()=>[v("连续打卡")]),_:1}),i(t,{class:"stat-value blue"},{default:u(()=>{var a;return[v(_((null==(a=C.value)?void 0:a.statistics.achievements.continuousCheckIn)||0)+"天",1)]}),_:1})]),_:1}),i(l,{class:"stat-item"},{default:u(()=>[i(t,{class:"stat-label"},{default:u(()=>[v("累计训练")]),_:1}),i(t,{class:"stat-value blue"},{default:u(()=>{var a;return[v(_((null==(a=C.value)?void 0:a.statistics.trading.totalTraining)||0)+"次",1)]}),_:1})]),_:1})]),_:1})),i(o,{class:"logout-btn",onClick:P},{default:u(()=>[i(l,{class:"logout-icon fa-icon logout-icon-fa"}),i(t,{class:"logout-text"},{default:u(()=>[v("安全退出")]),_:1})]),_:1}),i(x)]),_:1})]),_:1})}}}),[["__scopeId","data-v-9491d7d8"]]);export{w as default};
