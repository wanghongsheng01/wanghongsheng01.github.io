var e=(e,t,a)=>new Promise((s,l)=>{var o=e=>{try{c(a.next(e))}catch(t){l(t)}},n=e=>{try{c(a.throw(e))}catch(t){l(t)}},c=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,n);c((a=a.apply(e,t)).next())});import{d as t,r as a,c as s,o as l,s as o,e as n,w as c,v as i,i as r,N as u,O as f,f as d,g as p,J as _,l as m,j as y,k as g,x as k,P as v,t as h,F as w,y as x,G as b,C,D as j}from"./index-BWcxsYn8.js";import{_ as W}from"./uni-popup.Q0R9iG8O.js";import{m as P}from"./mockApi.Dwynr1J8.js";import{N as R}from"./NavigationBar.BembfXLU.js";import{_ as N}from"./_plugin-vue_export-helper.BCo6x5W8.js";const q=N(t({__name:"wrong-book",setup(t,{expose:N}){const q=a(!0),B=a({totalWrong:0,todayWrong:0,wrongRate:0,questionsByType:[]}),T=a(null),I=2*Math.PI*90,Q=s(()=>{const e=B.value.wrongRate/100;return I*(1-e)});l(()=>{D()});const D=()=>e(this,null,function*(){try{q.value=!0;const e=yield P.getWrongQuestions();200===e.code?B.value=e.data:o({title:e.message,icon:"none"})}catch(e){console.error("Âä†ËΩΩÈîôÈ¢òÊú¨Â§±Ë¥•:",e),o({title:"Âä†ËΩΩÂ§±Ë¥•",icon:"none"})}finally{q.value=!1}}),$=e=>({single:"ÂçïÈÄâÈ¢ò",multiple:"Â§öÈÄâÈ¢ò",judge:"Âà§Êñ≠È¢ò"}[e]||"Êú™Áü•È¢òÂûã"),A=()=>{var e;null==(e=T.value)||e.open()},F=()=>{var e;null==(e=T.value)||e.close()},G=()=>{F(),b({title:"ÁßªÈô§ËÆæÁΩÆ",content:"Á≠îÂØπÂá†Ê¨°ÂêéËá™Âä®ÁßªÈô§ÈîôÈ¢òÔºü",editable:!0,placeholderText:"ËØ∑ËæìÂÖ•Ê¨°Êï∞ÔºàÈªòËÆ§3Ê¨°Ôºâ",success:t=>e(this,null,function*(){if(t.confirm){const a=parseInt(t.content||"3");if(isNaN(a)||a<1)return void o({title:"ËØ∑ËæìÂÖ•ÊúâÊïàÊ¨°Êï∞",icon:"none"});try{const e=yield P.manageWrongQuestions("setRemoveCount",{removeCount:a});200===e.code?o({title:e.message,icon:"success"}):o({title:e.message,icon:"none"})}catch(e){console.error("ËÆæÁΩÆÂ§±Ë¥•:",e),o({title:"ËÆæÁΩÆÂ§±Ë¥•",icon:"none"})}}})})},J=()=>{F(),b({title:"Á°ÆËÆ§Ê∏ÖÁ©∫",content:"Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâÈîôÈ¢òÂêóÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊÅ¢Â§ç„ÄÇ",confirmColor:"#f44336",success:t=>e(this,null,function*(){if(t.confirm)try{C({title:"Ê∏ÖÁ©∫‰∏≠..."});const e=yield P.manageWrongQuestions("clear");200===e.code?(o({title:"Ê∏ÖÁ©∫ÊàêÂäü",icon:"success"}),yield D()):o({title:e.message,icon:"none"})}catch(e){console.error("Ê∏ÖÁ©∫Â§±Ë¥•:",e),o({title:"Ê∏ÖÁ©∫Â§±Ë¥•",icon:"none"})}finally{j()}})})};return N({onPullDownRefresh:()=>e(this,null,function*(){try{yield D(),o({title:"Âà∑Êñ∞ÊàêÂäü",icon:"success"})}catch(e){o({title:"Âà∑Êñ∞Â§±Ë¥•",icon:"none"})}finally{i()}})}),(e,t)=>{const a=r,s=y,l=m,i=u(f("uni-popup"),W);return d(),n(a,{class:"wrong-book-page"},{default:c(()=>[p(R,{title:"ÈîôÈ¢òÊú¨"}),p(a,{class:"page-content"},{default:c(()=>[p(a,{class:"page-header"},{default:c(()=>[p(l,{class:"manage-btn",onClick:A},{default:c(()=>[p(a,{class:"btn-icon fa-icon manage-icon-fa"}),p(s,{class:"btn-text"},{default:c(()=>[g("ÈîôÈ¢òÁÆ°ÁêÜ")]),_:1})]),_:1})]),_:1}),q.value?(d(),n(a,{key:1,class:"loading-section"},{default:c(()=>[p(a,{class:"skeleton skeleton-circle"}),p(a,{class:"skeleton-stats"},{default:c(()=>[(d(),k(w,null,x(2,e=>p(a,{class:"skeleton skeleton-stat",key:e})),64))]),_:1})]),_:1})):(d(),n(a,{key:0,class:"stats-section"},{default:c(()=>[p(a,{class:"wrong-rate-chart"},{default:c(()=>[p(a,{class:"chart-container"},{default:c(()=>{return[(d(),k("svg",{class:"pie-chart",viewBox:"0 0 200 200"},[v("circle",{cx:"100",cy:"100",r:"90",fill:"none",stroke:"#e3f2fd","stroke-width":"20"}),v("circle",{cx:"100",cy:"100",r:"90",fill:"none",stroke:(e=B.value.wrongRate,e>=50?"#f44336":e>=30?"#ff9800":e>=15?"#ffc107":"#4caf50"),"stroke-width":"20","stroke-linecap":"round","stroke-dasharray":I,"stroke-dashoffset":Q.value,transform:"rotate(-90 100 100)",class:"progress-circle"},null,8,["stroke","stroke-dashoffset"])])),p(a,{class:"chart-text-overlay"},{default:c(()=>[p(a,{class:"rate-value"},{default:c(()=>[g(h(B.value.wrongRate)+"%",1)]),_:1}),p(a,{class:"rate-label"},{default:c(()=>[g("ÈîôÈ¢òÁéá")]),_:1})]),_:1})];var e}),_:1})]),_:1}),p(a,{class:"stats-grid"},{default:c(()=>[p(a,{class:"stat-item"},{default:c(()=>[p(s,{class:"stat-value"},{default:c(()=>[g(h(B.value.totalWrong),1)]),_:1}),p(s,{class:"stat-label"},{default:c(()=>[g("ÂÖ®ÈÉ®ÈîôÈ¢ò")]),_:1})]),_:1}),p(a,{class:"stat-item"},{default:c(()=>[p(s,{class:"stat-value"},{default:c(()=>[g(h(B.value.todayWrong),1)]),_:1}),p(s,{class:"stat-label"},{default:c(()=>[g("‰ªäÊó•ÈîôÈ¢ò")]),_:1})]),_:1})]),_:1})]),_:1})),q.value?(d(),n(a,{key:3,class:"question-types loading"},{default:c(()=>[(d(),k(w,null,x(3,e=>p(a,{class:"type-item skeleton-item",key:e},{default:c(()=>[p(a,{class:"skeleton skeleton-type"}),p(a,{class:"skeleton skeleton-count"})]),_:2},1024)),64))]),_:1})):(d(),n(a,{key:2,class:"question-types"},{default:c(()=>[(d(!0),k(w,null,x(B.value.questionsByType,e=>(d(),n(a,{key:e.type,class:"type-item",onClick:t=>(e=>{0!==e.count?b({title:"ÊèêÁ§∫",content:`ËøõÂÖ•${$(e.type)}ÈîôÈ¢òÁªÉ‰π†ÔºåÂÖ±${e.count}È¢ò`,confirmText:"ÂºÄÂßãÁªÉ‰π†",success:e=>{e.confirm&&o({title:"ÂäüËÉΩÂºÄÂèë‰∏≠...",icon:"none"})}}):o({title:"ËØ•È¢òÂûãÊöÇÊó†ÈîôÈ¢ò",icon:"none"})})(e)},{default:c(()=>[p(a,{class:"type-info"},{default:c(()=>[p(s,{class:"type-name"},{default:c(()=>[g(h($(e.type)),1)]),_:2},1024),p(s,{class:"type-count"},{default:c(()=>[g(h(e.count)+"È¢ò",1)]),_:2},1024)]),_:2},1024),p(s,{class:"arrow-icon"},{default:c(()=>[g("‚Ä∫")]),_:1})]),_:2},1032,["onClick"]))),128))]),_:1})),q.value||0!==B.value.totalWrong?_("",!0):(d(),n(a,{key:4,class:"empty-state"},{default:c(()=>[p(a,{class:"empty-icon"},{default:c(()=>[g("üéâ")]),_:1}),p(s,{class:"empty-title"},{default:c(()=>[g("ÊöÇÊó†ÈîôÈ¢ò")]),_:1}),p(s,{class:"empty-desc"},{default:c(()=>[g("ÁªßÁª≠Âä™ÂäõÔºå‰øùÊåÅ‰ºòÁßÄÁöÑÁ≠îÈ¢òËÆ∞ÂΩïÔºÅ")]),_:1})]),_:1})),p(i,{ref_key:"managePopup",ref:T,type:"bottom","background-color":"transparent"},{default:c(()=>[p(a,{class:"manage-modal-wrapper"},{default:c(()=>[p(a,{class:"manage-modal"},{default:c(()=>[p(a,{class:"modal-header"},{default:c(()=>[p(s,{class:"modal-title"},{default:c(()=>[g("ÈîôÈ¢òÁÆ°ÁêÜ")]),_:1}),p(a,{class:"header-divider"})]),_:1}),p(a,{class:"manage-options"},{default:c(()=>[p(l,{class:"manage-option",onClick:G},{default:c(()=>[p(a,{class:"option-icon-wrapper"},{default:c(()=>[p(a,{class:"option-icon fa-icon target-icon"})]),_:1}),p(a,{class:"option-info"},{default:c(()=>[p(s,{class:"option-title"},{default:c(()=>[g("ÁßªÈô§ËÆæÁΩÆ")]),_:1}),p(s,{class:"option-desc"},{default:c(()=>[g("ËÆæÁΩÆÁ≠îÂØπÂá†Ê¨°ÂêéËá™Âä®ÁßªÈô§ÈîôÈ¢ò")]),_:1})]),_:1}),p(a,{class:"option-arrow"},{default:c(()=>[g("‚Ä∫")]),_:1})]),_:1}),p(l,{class:"manage-option danger",onClick:J},{default:c(()=>[p(a,{class:"option-icon-wrapper danger-bg"},{default:c(()=>[p(a,{class:"option-icon fa-icon trash-icon"})]),_:1}),p(a,{class:"option-info"},{default:c(()=>[p(s,{class:"option-title"},{default:c(()=>[g("Ê∏ÖÁ©∫ÈîôÈ¢òÊú¨")]),_:1}),p(s,{class:"option-desc"},{default:c(()=>[g("Âà†Èô§ÊâÄÊúâÈîôÈ¢òËÆ∞ÂΩï")]),_:1})]),_:1}),p(a,{class:"option-arrow"},{default:c(()=>[g("‚Ä∫")]),_:1})]),_:1})]),_:1}),p(l,{class:"cancel-btn",onClick:F},{default:c(()=>[g(" ÂèñÊ∂à ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})}}}),[["__scopeId","data-v-25068f91"]]);export{q as default};
